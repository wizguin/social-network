extends user

mixin post(post)
  - var isRepost = (post.reposter) ? true : false
  - var isReply = (post.originalPoster) ? true : false

  .post.container.border-bottom(data-id=post.id)

    if isRepost
      p.repost-text
        i.fas.fa-arrow-right
        |
        | #{post.reposter} Reposted
    else if isReply
      p.repost-text
        i.far.fa-comment
        |
        | #{post.username} Replied to #{post.originalPoster}

    a(href=`/user/${post.username}`)
      .avatar-sm
        img(src=`/images/avatar/${post.avatar}.webp`, onerror='this.src="/images/avatar/default.webp"')
    .h6
      a(href=`/user/${post.username}`) #{post.username}

    p #{post.text}
    if post.image
      .post-image
        img(src=`/images/upload/${post.image}.webp`)

    table.post-buttons
      tbody
        tr
          td.i.far.fa-comment.comment-button(data-id=post.id, data-toggle='modal')
          if post.isLiked
            td.i.fas.fa-heart.liked.like-button(data-id=post.id, data-action='unlike')
          else
            td.i.far.fa-heart.like-button(data-id=post.id, data-action='like')
          td.i.fas.fa-arrow-right.repost-button(data-id=post.id)
          if isRepost
            td #{post.originalTimestamp}
          else
            td #{post.timestamp}

block profileContent

  //---------- Profile posts ----------//

  #posts.card-body.border-left.border-right

    each post in profile.content
      +post(post)

  //---------- Modals ----------//

  //- Comment modal
  #commentModal.modal.fade(tabindex='-1', role='dialog', aria-labelledby='commentModalLabel', aria-hidden='true')

    .modal-dialog(role='document')

      .modal-content

        .modal-header
          h5#commentModalLabel.modal-title Comment
          button.close(type='button', data-dismiss='modal', aria-label='Close')
            span(aria-hidden='true') Ã—

        .modal-body
          form(action='/post/comment', method='post', id='comment-form')
            .form-group
              textarea.form-control(rows='5', name='postText')
              button.btn.btn-primary.mr-1.mt-1(type='button')
                i.far.fa-image
              button.btn.btn-primary.mt-1(type='submit') Post
